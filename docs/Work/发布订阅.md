# 发布订阅

<img :src="$withBase('/image/发布订阅.png')">

```js
const EventCache = {
    //保存事件数组
    list: [], 
    //事件订阅 - event：事件名， fn：事件回调
    on(event, fn) { 
        const _this = this;
        //将事件回调保存到列表中，[list[event]]是一个二维数组
        (_this.list[event] || (_this.list[event] = [])).push(fn) 

        return _this
    },
    //事件发布
    emit() {
        const _this = this
        const event = [].shift.call(arguments), fns = [ ..._this.list[event]]

        const fns = [ ..._this.list[evnet] ]

        if(!fns || fns.length === 0) {
            return false
        }

        fns.forEach(fn => {
            fn.apply(this, arguments)
        })

        return this
    }
}

const user1 = function() {
    console.log('user1')
}

const user2 = function() {
    console.log('user2')
}

//订阅user事件，传入user1 user2回调函数
EventCache.on('user', user1)
EventCache.on('user', user2)

//发布事件
EventCache.emit('user')

```